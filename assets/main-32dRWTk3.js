var O=Object.defineProperty;var j=(t,e,o)=>e in t?O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var c=(t,e,o)=>(j(t,typeof e!="symbol"?e+"":e,o),o);import{i as k,g as T,a as C,r as l,o as P,$ as s,b as A,c as I,S as f,d as p,D as g,P as S,e as D,R as B,f as v,M as W,h as V,s as b,u as L,j as U,k as z,l as G}from"./Ship-BgBp64_2.js";class E{constructor(e){c(this,"size");c(this,"grid");this.size=e,this.grid=this.createGrid(e)}createGrid(e){let o=0;return Array.from({length:e*e},()=>new H(o++,"empty",!1))}}class H{constructor(e,o,a){c(this,"index");c(this,"inside");c(this,"isHit");this.index=e,this.inside=o,this.isHit=a}}const $={apiKey:"AIzaSyAL0AmcXBH1zr7EKL8pE3-Joge0Pxyljfg",authDomain:"battle-of-the-high-seas.firebaseapp.com",databaseURL:"https://battle-of-the-high-seas-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"battle-of-the-high-seas",storageBucket:"battle-of-the-high-seas.appspot.com",messagingSenderId:"95988470782",appId:"1:95988470782:web:b745e9ce5edeeebbe566af",measurementId:"G-ZVDQNVR4JY"};k($);const h=T(),R=C();let r,d,n;const Y=l(h,"users");P(R,async t=>{if(U(Y,e=>{if(e.exists()){const o=e.val(),a=o?Object.keys(o).length:0;s(".count").text(a)}else s(".count").text(0)}),t){d=l(h,"users/"+t.uid),r=t.uid;try{const e=J(r);e?(n=e,await b(d,{name:n})):(n=K(),await b(d,{name:n}),F(r,n)),z(d).remove()}catch(e){console.error("Error fetching user data:",e)}}else G(R).catch(e=>{console.error("Error signing in anonymously:",e)})});function F(t,e){localStorage.setItem(t,e)}function J(t){const e=localStorage.getItem(t);return e||null}s("#createRoomBtn").on("click",async function(){let t=!1,e=Math.floor(Math.random()*9e3)+1e3;for(;!t;)await A(I(l(h),"rooms/"+e)).then(async o=>{if(!o.exists()){const a=[new f("ship-3-1","3x1",3,-1,p.INACTIVE,3,g.ROW),new f("ship-2-1","2x1",2,-1,p.INACTIVE,2,g.ROW)],i=new Map;i.set(r,new S(r,n,new E(10),a,D.NOT_READY));const u=new B(e,i,v.WAITING,W.DEFAULT,V.DEFAULT,r),m={...u,players:x(u.players)};await b(l(h,"rooms/"+e),m).then(()=>{t=!0,M(e.toString())}).catch(y=>console.log("Error creating room",y))}}).catch(o=>{console.log(o.message)}).finally(()=>e=Math.floor(Math.random()*9e3)+1e3)});s("#submitCode").click(async()=>{let t=parseInt(s("#roomIdInput").val()+"");if(!t||t>=1e4||t<=999){alert("Please enter a room ID");return}const e=await A(I(l(h),"rooms/"+t));if(e.exists()){const o=e.val(),a=o.players||{},i=new Map(Object.entries(a));if(i.size<2){const u=[new f("ship-3-1","3x1",3,-1,p.INACTIVE,3,g.ROW),new f("ship-2-1","2x1",2,-1,p.INACTIVE,2,g.ROW)],m=new S(r,n,new E(10),u,D.NOT_READY);i.set(m.id,m);const y={...o,players:x(i)};L(I(l(h),"rooms/"+t),y).then(()=>{M(t.toString())}).catch(N=>console.log("Error adding player to room",N))}else alert("Room is already full.")}else console.log("Room doesn't exist")});function x(t){const e={};return t.forEach((o,a)=>{e[a]=o}),e}let w=!1;s("#joinRoomBtn").on("click",function(){w||(w=!0,s(".pop-up").show())});s(".close-btn").click(()=>{s(".pop-up").hide(),w=!1});function M(t){window.location.href=`/Battle-of-the-High-Seas/src/pages/game-view.html?roomId=${t}`}function K(){const t=["Silly","Goofy","Wobbly","Clumsy","Bouncy","Quirky","Zany","Snappy","Wacky","Bizarre"],e=["Penguin","Banana","Noodle","Pancake","Nugget","Pickle","Wombat","Squirrel","Doodle","Llama"],o=t[Math.floor(Math.random()*t.length)],a=e[Math.floor(Math.random()*e.length)];return`${o} ${a}`}
