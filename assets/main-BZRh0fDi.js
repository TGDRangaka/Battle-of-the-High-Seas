var O=Object.defineProperty;var T=(t,e,o)=>e in t?O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var c=(t,e,o)=>(T(t,typeof e!="symbol"?e+"":e,o),o);import{i as j,g as k,a as C,r as l,S as u,b as m,D as d,o as P,$ as s,c as R,d as y,P as A,e as S,R as B,f as W,M as v,h as V,s as I,u as L,j as U,k as z,l as G}from"./Ship-mtCjgaWR.js";class D{constructor(e){c(this,"size");c(this,"grid");this.size=e,this.grid=this.createGrid(e)}createGrid(e){let o=0;return Array.from({length:e*e},()=>new H(o++,"empty",!1))}}class H{constructor(e,o,a){c(this,"index");c(this,"inside");c(this,"isHit");this.index=e,this.inside=o,this.isHit=a}}const $={apiKey:"AIzaSyAL0AmcXBH1zr7EKL8pE3-Joge0Pxyljfg",authDomain:"battle-of-the-high-seas.firebaseapp.com",databaseURL:"https://battle-of-the-high-seas-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"battle-of-the-high-seas",storageBucket:"battle-of-the-high-seas.appspot.com",messagingSenderId:"95988470782",appId:"1:95988470782:web:b745e9ce5edeeebbe566af",measurementId:"G-ZVDQNVR4JY"};j($);const h=k(),w=C();let r,p,n;const Y=l(h,"users"),E=[new u("ship-4-2","4x1",4,-1,m.INACTIVE,4,d.ROW),new u("ship-4-1","4x1",4,-1,m.INACTIVE,4,d.ROW),new u("ship-3-2","3x1",3,-1,m.INACTIVE,3,d.ROW),new u("ship-3-1","3x1",3,-1,m.INACTIVE,3,d.ROW),new u("ship-2-1","2x1",2,-1,m.INACTIVE,2,d.ROW)];P(w,async t=>{if(U(Y,e=>{if(e.exists()){const o=e.val(),a=o?Object.keys(o).length:0;s(".count").text(a)}else s(".count").text(0)}),t){p=l(h,"users/"+t.uid),r=t.uid;try{const e=J(r);e?(n=e,await I(p,{name:n})):(n=K(),await I(p,{name:n}),F(r,n)),z(p).remove()}catch(e){console.error("Error fetching user data:",e)}}else G(w).catch(e=>{console.error("Error signing in anonymously:",e)})});function F(t,e){localStorage.setItem(t,e)}function J(t){const e=localStorage.getItem(t);return e||null}s("#createRoomBtn").on("click",async function(){let t=!1,e=Math.floor(Math.random()*9e3)+1e3;for(;!t;)await R(y(l(h),"rooms/"+e)).then(async o=>{if(!o.exists()){const a=new Map;a.set(r,new A(r,n,new D(10),E,S.NOT_READY));const i=new B(e,a,W.WAITING,v.DEFAULT,V.DEFAULT,r),f={...i,players:x(i.players)};await I(l(h,"rooms/"+e),f).then(()=>{t=!0,N(e.toString())}).catch(g=>console.log("Error creating room",g))}}).catch(o=>{console.log(o.message)}).finally(()=>e=Math.floor(Math.random()*9e3)+1e3)});s("#submitCode").click(async()=>{let t=parseInt(s("#roomIdInput").val()+"");if(!t||t>=1e4||t<=999){alert("Please enter a room ID");return}const e=await R(y(l(h),"rooms/"+t));if(e.exists()){const o=e.val(),a=o.players||{},i=new Map(Object.entries(a));if(i.size<2){const f=new A(r,n,new D(10),E,S.NOT_READY);i.set(f.id,f);const g={...o,players:x(i)};L(y(l(h),"rooms/"+t),g).then(()=>{N(t.toString())}).catch(M=>console.log("Error adding player to room",M))}else alert("Room is already full.")}else console.log("Room doesn't exist")});function x(t){const e={};return t.forEach((o,a)=>{e[a]=o}),e}let b=!1;s("#joinRoomBtn").on("click",function(){b||(b=!0,s(".pop-up").show())});s(".close-btn").click(()=>{s(".pop-up").hide(),b=!1});function N(t){window.location.href=`/Battle-of-the-High-Seas/src/pages/game-view.html?roomId=${t}`}function K(){const t=["Silly","Goofy","Wobbly","Clumsy","Bouncy","Quirky","Zany","Snappy","Wacky","Bizarre"],e=["Penguin","Banana","Noodle","Pancake","Nugget","Pickle","Wombat","Squirrel","Doodle","Llama"],o=t[Math.floor(Math.random()*t.length)],a=e[Math.floor(Math.random()*e.length)];return`${o} ${a}`}
