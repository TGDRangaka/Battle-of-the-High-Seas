var ee=Object.defineProperty;var te=(e,t,i)=>t in e?ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var R=(e,t,i)=>(te(e,typeof t!="symbol"?t+"":t,i),i);import{i as se,g as ie,a as ae,o as oe,$ as s,r as c,c as I,e as O,m as ne,j as w,f as H,D as y,b,u as A,n as re,l as le,d as de}from"./Ship-mtCjgaWR.js";const he="/Battle-of-the-High-Seas/assets/board-bg2-BJ8gmd7w.gif",ce=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"})),ge="/Battle-of-the-High-Seas/assets/captain-nvN02mGO.png",ue=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"})),fe="/Battle-of-the-High-Seas/assets/fire-BMoH9c85.gif",pe=Object.freeze(Object.defineProperty({__proto__:null,default:fe},Symbol.toStringTag,{value:"Module"})),me="/Battle-of-the-High-Seas/assets/hit-shot-C5IocONJ.jpg",ye=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"})),be="/Battle-of-the-High-Seas/assets/lobby-bg-Doj_4GKl.jpg",_e=Object.freeze(Object.defineProperty({__proto__:null,default:be},Symbol.toStringTag,{value:"Module"})),Ae="/Battle-of-the-High-Seas/assets/logo-NdU70Ygn.png",Se=Object.freeze(Object.defineProperty({__proto__:null,default:Ae},Symbol.toStringTag,{value:"Module"})),Ie="/Battle-of-the-High-Seas/assets/message-bg-ChXeVhNe.jpg",Te=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"})),ve="/Battle-of-the-High-Seas/assets/missed-shot-CZNQCz4t.png",Ee=Object.freeze(Object.defineProperty({__proto__:null,default:ve},Symbol.toStringTag,{value:"Module"})),Ce="/Battle-of-the-High-Seas/assets/player-ship-fire-DqB_8Afc.gif",we=Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"})),Ye="/Battle-of-the-High-Seas/assets/ship-2-1-Ctcwa05g.png",Oe=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"})),xe="/Battle-of-the-High-Seas/assets/ship-3-1-DBkbElqy.png",je=Object.freeze(Object.defineProperty({__proto__:null,default:xe},Symbol.toStringTag,{value:"Module"})),Ne="/Battle-of-the-High-Seas/assets/ship-3-2-BJPXlfHt.png",Be=Object.freeze(Object.defineProperty({__proto__:null,default:Ne},Symbol.toStringTag,{value:"Module"})),Me="/Battle-of-the-High-Seas/assets/ship-4-1-C4W2Nih_.png",Re=Object.freeze(Object.defineProperty({__proto__:null,default:Me},Symbol.toStringTag,{value:"Module"})),Pe="data:image/png;base64,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",ze=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"})),He="/Battle-of-the-High-Seas/assets/ship-5-1-DqDdTOJq.png",ke=Object.freeze(Object.defineProperty({__proto__:null,default:He},Symbol.toStringTag,{value:"Module"})),De="/Battle-of-the-High-Seas/assets/ship-6-1-BbM6-ehE.png",Le=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}));class We{constructor(t,i,o,n){R(this,"isHaveWinner");R(this,"winner");R(this,"selectedCell");R(this,"firedShotStatus");this.isHaveWinner=t,this.winner=i,this.selectedCell=o,this.firedShotStatus=n}}var z=(e=>(e.HIT="hit",e.MISS="miss",e.DESTROYED="destroyed",e.NOT_FIRED="not_fired",e))(z||{}),v=(e=>(e.PLAYER_MISS="player_miss",e.PLAYER_HIT="player_hit",e.PLAYER_SINK="player_sink",e.ENEMY_MISS="enemy_miss",e.ENEMY_HIT="enemy_hit",e.ENEMY_SINK="enemy_sink",e))(v||{});function E(e){switch(e){case"player_miss":return C(Ue);case"player_hit":return C(Ge);case"player_sink":return C(Ve);case"enemy_miss":return C(Qe);case"enemy_hit":return C(Je);case"enemy_sink":return C(Ke);default:return""}}const C=e=>{const t=Math.floor(Math.random()*e.length);return e[t]},Ue=["You missed! Better luck next time.","Splash! Your shot landed in the water.","No hit! The enemy ship is safe.","Try again! Your shot missed the target.","Oops! That was a miss.","Keep going! You can do better.","The enemy is still afloat, you missed!","Your shot went wide of the mark.","Miss! The enemy dodged your attack.","No luck this time, aim carefully!"],Ge=["Direct hit! The enemy ship is damaged.","Nice shot! You hit the enemy.","Boom! You scored a hit.","Great aim! The enemy ship took a hit.","Hit confirmed! The enemy is hurting.","Well done! You hit their ship.","Bullseye! The enemy ship is struck.","You're on target! Another hit.","The enemy ship is taking damage, good shot!","Your shot hit its mark!"],Ve=["You sank an enemy ship! Well done!","Enemy ship destroyed! Great job!","Fantastic! You sunk their ship.","Boom! Enemy ship has been sunk.","Congratulations! You took down their ship.","Enemy vessel down! You're on fire!","One less enemy ship to worry about!","Great work! The enemy ship is sinking.","You've obliterated their ship!","Victory! An enemy ship is sinking."],Qe=["The enemy missed! Your ship is safe.","Splash! The enemy shot landed in the water.","No hit! The enemy failed to strike.","Phew! The enemy shot missed you.","The enemy missed the mark.","You're safe! The enemy's shot went wide.","The enemy shot didn't find its target.","The enemy missed your ship!","Their shot went astray.","The enemy's attack was unsuccessful."],Je=["The enemy hit your ship!","Direct hit by the enemy!","Your ship took a hit!","The enemy scored a hit!","Boom! The enemy hit your ship.","Your ship is damaged!","The enemy shot hit its mark.","Ouch! Your ship was struck.","Your ship is taking damage!","The enemy's attack was successful."],Ke=["Oh no! The enemy sank your ship!","Your ship has been destroyed by the enemy.","The enemy took down your ship!","Enemy victory! Your ship is sinking.","Your ship is gone! The enemy sank it.","The enemy obliterated your ship!","You've lost a ship to the enemy.","One of your ships has been sunk!","Disaster! The enemy sank your vessel.","Your ship is sinking!"],Fe={apiKey:"AIzaSyAL0AmcXBH1zr7EKL8pE3-Joge0Pxyljfg",authDomain:"battle-of-the-high-seas.firebaseapp.com",databaseURL:"https://battle-of-the-high-seas-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"battle-of-the-high-seas",storageBucket:"battle-of-the-high-seas.appspot.com",messagingSenderId:"95988470782",appId:"1:95988470782:web:b745e9ce5edeeebbe566af",measurementId:"G-ZVDQNVR4JY"};se(Fe);const g=ie(),Ze=new URLSearchParams(window.location.search);let u=Ze.get("roomId");const G=ae();let k,V,Q;oe(G,async e=>{if(e){V=c(g,"users/"+e.uid),k=e.uid;try{Q=await I(V),Q.exists()}catch(t){console.error("Error fetching user data:",t)}}else le(G).catch(t=>{console.error("Error signing in anonymously:",t)})});let j,a,S,x;const D=s("#dropzone");let J;const N=c(g,"rooms/"+u);I(N).then(e=>{if(e.exists()){x=e.val();const t=new Map(Object.entries(x.players||{}));s("#roomId").text(`ROOM ID: #${x.roomId}`);const i=t.get(k);i&&(a=i,j=c(g,`rooms/${u}/players/${k}`),s(".player .player-name").text(a.name),a.state===O.NOT_READY&&s(".player button").prop("disabled",!0)),$e(i.board),J=s(".cells"),J&&qe()}else console.error("no room to get...")});ne(c(g,`rooms/${u}/players`),e=>{e.exists()&&e.val().id!==k&&(S=e.val(),s(".enemy .player-name").text(S.name),T("Player Joined"))});let L=!1;w(c(g,`rooms/${u}/players`),async e=>{if(L)return;if((await I(N)).val().status!==H.WAITING){Z(),F(),!L&&q();return}const i=new Map(Object.entries(e.val()||{}));let o=[!1,!1];i.forEach((n,d)=>{d===k?n.state!==O.NOT_READY&&(o[0]=!0):n.state!==O.NOT_READY&&s(".enemy button").prop("disabled",!1)&&(o[1]=!0)}),o[0]&&o[1]&&A(N,{status:H.PLAYING}).then(()=>{Z(),F(),a.state=O.PLAYING,A(j,a),q()}).catch(n=>console.log("error updating room status to playing",n))});let P=null;function qe(){s(".guide-pane, #dropzone").on("dragstart",".ship",function(e){if(x.status!==H.WAITING)return;P=s(this);const t=a.ships.find(n=>n.id===P.attr("id"));if(!t)return!1;const i=s(this).data("size").split("x"),o=parseInt(i[0]);D.on("dragover",".cell",function(n){n.preventDefault();let d=s(".cell").index(this),l=[];for(let r=0;r<o;r++){let f=t.direction===y.ROW?r:r*10;const W=d+f;l.push(W)}s(".cell").removeClass("highlight"),s(".cell").removeClass("warning"),K(d,t)?l.map(r=>s(".cell").eq(r).addClass("highlight")):l.map(r=>s(".cell").eq(r).addClass("warning"))})}),D.on("drop",".cell",function(e){if(x.status!==H.WAITING)return;const t=s(this).data("index"),i=a.ships.find(o=>o.id===P.attr("id"));if(i){if(K(t,i)){e.preventDefault(),s(".cell").removeClass("highlight"),s(".cell").removeClass("warning"),s(this).prepend(P);const o=a.ships.find(n=>n.id===P.attr("id"));o&&(o.index=t,o.status=b.PLACED,a.ships.filter(n=>n.status===b.INACTIVE).length==0?s(".player button").prop("disabled",!1):s(".player button").prop("disabled",!0),A(j,a).catch(n=>console.log("error while updating ships",n)));return}s(".cell").removeClass("highlight"),s(".cell").removeClass("warning")}}),D.on("click",".cell",function(){if(x.status!==H.WAITING)return;const e=s(this).data("index"),t=a.ships.find(i=>i.index===e);t&&(et(t,a.ships)?(t.direction===y.COLUMN?(s(".cell").eq(t.index).find(".ship").attr("direction","row"),t.direction=y.ROW):(s(".cell").eq(t.index).find(".ship").attr("direction","column"),t.direction=y.COLUMN),A(j,{ships:a.ships}).catch(i=>console.log("error while updating ships",i))):(s(".cell").eq(e).addClass("warning"),setTimeout(()=>{s(".cell").eq(e).removeClass("warning")},1500)))}),Xe(a.ships),tt(a.ships)}s(".player button").on("click",function(){a.state===O.NOT_READY&&A(j,{state:O.READY}).then(()=>{}).catch(e=>console.log("error while updating ships",e))});const Y=e=>{const t=`/src/assets/imgs/${e}`,o=Object.assign({"/src/assets/imgs/board-bg2.gif":ce,"/src/assets/imgs/captain.png":ue,"/src/assets/imgs/fire.gif":pe,"/src/assets/imgs/hit-shot.jpg":ye,"/src/assets/imgs/lobby-bg.jpg":_e,"/src/assets/imgs/logo.png":Se,"/src/assets/imgs/message-bg.jpg":Te,"/src/assets/imgs/missed-shot.png":Ee,"/src/assets/imgs/player-ship-fire.gif":we,"/src/assets/imgs/ship-2-1.png":Oe,"/src/assets/imgs/ship-3-1.png":je,"/src/assets/imgs/ship-3-2.png":Be,"/src/assets/imgs/ship-4-1.png":Re,"/src/assets/imgs/ship-4-2.png":ze,"/src/assets/imgs/ship-5-1.png":ke,"/src/assets/imgs/ship-6-1.png":Le})[t];return o?o.default:""};function Xe(e){for(let t of e){const i=Y(t.id+".png");console.log(`Loading image from path: ${i}`),t.status===b.INACTIVE&&s(".guide-pane .ships").append(`
            <div id="${t.id}" class="ship" draggable="true" data-size="${t.size}" direaction="column">
                <img src="${i}">
            </div>
        `),s(".fleet .ships").append(`
            <div id="${t.id}" class="ship" data-size="${t.size}" direaction="column">
                <img src="${i}">
            </div>
        `)}}function $e(e){const t=e.size*e.size;for(let i=0;i<t;i++)D.append(`<div data-index="${i}" class="cell"></div>`),s("#enemy-board .board").append(`<div data-index="${i}" class="cell"></div>`)}function K(e,t){let i=e%10;const o=Math.floor(e/10);let n=!0;if(t.direction===y.ROW){if(i+t.length>10)return!1;e:for(let d=0;d<t.length;d++){let l=e+d;for(let r of a.ships)if(r.status!==b.INACTIVE&&r.id!==t.id){if(r.direction===y.ROW){if(r.index===l){n=!1;break e}}else for(let f=0;f<r.length;f++)if(l===r.index+f*10){n=!1;break e}}}if(!n)return!1}else{if(o+t.length>10)return!1;e:for(let d=0;d<t.length;d++){let l=e+d*10;for(let r of a.ships)if(r.status!==b.INACTIVE&&r.id!==t.id){if(r.direction===y.COLUMN){if(r.index===l){n=!1;break e}}else for(let f=0;f<r.length;f++)if(l===r.index+f){n=!1;break e}}}if(!n)return!1}return!0}function et(e,t){let i=!0;const o=e.index;if(e.direction===y.ROW){if(Math.floor(o/10)+e.length>10)return!1;for(let n=1;n<e.length;n++){let d=o+n*10;if(d>=100||(t.forEach(l=>{if(l.status!==b.INACTIVE&&l.id!==e.id){if(l.direction===y.COLUMN){if(l.index===d){i=!1;return}}else if(l.index<=d&&l.index+l.length>d){i=!1;return}}}),!i))return!1}}else{if(o%10+e.length>10)return!1;for(let n=1;n<e.length;n++){let d=o+n;if(t.forEach(l=>{if(l.status!==b.INACTIVE&&l.id!==e.id){if(l.direction===y.ROW){if(l.index===d){i=!1;return}}else for(let r=0;r<l.length;r++)if(d===l.index+r*10){i=!1;return}}}),!i)return!1}}return!0}function tt(e){for(let t of e)if(t.status!=b.INACTIVE){const i=t.index,o=t.direction,n=Y(t.id+".png");let d=s(".cell").eq(i);o==y.ROW?d.append(`
                <div id="${t.id}" class="ship" draggable="true" data-size="${t.size}" direction="row">
                    <img src="${n}" alt="">
                </div>
                `):d.append(`
                <div id="${t.id}" class="ship" draggable="true" data-size="${t.size}" direction="column">
                    <img src="${n}" alt="">
                </div>
                `)}a.ships.filter(t=>t.status===b.INACTIVE).length==0?s(".player button").prop("disabled",!1):s(".player button").prop("disabled",!0)}function F(){a.ships.map(e=>{const t=e.index;if(e.direction===y.ROW)for(let o=0;o<e.length;o++)a.board.grid[t+o].inside=e.id;else for(let o=0;o<e.length;o++)a.board.grid[t+o*10].inside=e.id})}function Z(){s(".guide-pane").hide(),s(".board-area + .right").show(),s("aside").removeClass("hidden"),s(".player-info button").hide(),s("#dropzone .ship[draggable='true']").attr("draggable","false"),s("#dropzone .ship").css("zIndex","-1"),s("#turnPlayerName").show()}async function q(){if(L)return;s(".cell").append("<div class='shot'></div>"),I(de(c(g),`rooms/${u}/gameStat`)).then(p=>{p.exists()||A(N,{gameStat:new We(!1,null,-1,z.NOT_FIRED)}).then(()=>{}).catch(h=>console.error("Error while adding game stat",h))});const e=c(g,`rooms/${u}/turn`),t=c(g,`rooms/${u}/gameStat`),i=c(g,`rooms/${u}/gameStat/isHaveWinner`),o=c(g,`rooms/${u}/gameStat/selectedCell`),n=c(g,`rooms/${u}/players/${S.id}/board/grid`),d=c(g,`rooms/${u}/players/${S.id}`),l=c(g,`rooms/${u}/players/${a.id}/board/grid`);let f=(await I(c(g,`rooms/${u}/players/${S.id}/board/grid`))).val(),U=(await I(c(g,`rooms/${u}/players/${a.id}/board/grid`))).val();w(e,p=>{const h=p.val();s("#turnPlayerName").text(h==a.id?"YOUR TURN":"ENEMY TURN"),s("#turnPlayerName").css("color",h==a.id?"#9DFF21":"#ff2121")}),s("#enemy-board .board").on("click",".cell",async function(){if((await I(e)).val()===a.id){const h=s(this).index();if(f[h].isHit)return;await A(t,{selectedCell:h})}}),w(o,async p=>{const h=await I(d),m=p.val(),X=await I(e);if(m!=-1)if(X.val()===a.id){S=h.val();const B=S.board.grid[m];if(B.inside!=="empty"){let M=S.ships.findIndex(_=>_.id===B.inside);S.ships[M].health>1?T(E(v.PLAYER_HIT)):T(E(v.PLAYER_SINK));return}T(E(v.PLAYER_MISS))}else{const B=a.board.grid[m];let M=z.MISS;if(a.board.grid[m].isHit=!0,B.inside!=="empty"){let _=a.ships.findIndex($=>$.id===B.inside);if(!a.ships[_])return;a.ships[_].health>1?(a.ships[_].health=a.ships[_].health-1,a.ships[_].status=b.DAMAGED,M=z.HIT,T(E(v.ENEMY_HIT))):(a.ships[_].health=0,a.ships[_].status=b.DESTROYED,M=z.DESTROYED,T(E(v.ENEMY_SINK)))}else T(E(v.ENEMY_MISS));await A(t,{firedShotStatus:M}),A(j,a).then(async()=>{st(a.ships)&&await A(t,{isHaveWinner:!0,winner:S}),await A(N,{turn:a.id})}).catch(_=>console.log("error updating the player after attack",_))}}),w(l,async p=>{U=p.val(),U.map((h,m)=>{h.isHit&&s("#player-board .board .cell .shot").eq(m).html(h.inside==="empty"?`<img src="${Y("missed-shot.png")}" alt="missed"/>`:`<img src="${Y("hit-shot.jpg")}" alt="fire"/>`)})}),w(n,async p=>{f=p.val(),f.map((h,m)=>{h.isHit&&s("#enemy-board .board .cell .shot").eq(m).html(h.inside==="empty"?`<img src="${Y("missed-shot.png")}" alt="missed"/>`:`<img src="${Y("hit-shot.jpg")}" alt="fire"/>`)})}),w(i,async p=>{if(p.val()){const m=(await I(c(g,`rooms/${u}/gameStat/winner`))).val();T("Winner is "+m.name),s("#turnPlayerName").text(m==a.id?"YOUR WIN":"ENEMY WIN"),s("#turnPlayerName").css("color",m==a.id?"#9DFF21":"#ff2121")}}),L=!0}function st(e){return e.filter(t=>t.status===b.DESTROYED).length===e.length}s("#exitButton").click(async function(){await re(N)});function T(e){s("#messages").append(`
        <div class="message">
            <div class="img"></div>
            <div class="body">
                <p>${e}</p>
            </div>
        </div>
    `),setTimeout(()=>s("#messages").empty(),3e3)}
